<!--
  @description       :
  @author            : ChangeMeIn@UserSettingsUnder.SFDoc
  @group             :
  @last modified on  : 12-23-2023
  @last modified by  : ChangeMeIn@UserSettingsUnder.SFDoc
-->
<template>

    <c-container>

    <div class="top">
        <h1>Shopping Cart</h1>
        <lightning-button
        icon-name="utility:clear"
        class="empty-cart slds-m-bottom_x-large"
        onclick={handleConfirmClick}
        label="Empty Cart">
        </lightning-button>
    </div>

    <div class="slds-align_absolute-center">
        <lightning-spinner
                if:false={childSpinnerStatus}
                variant="brand"
                size="medium"
                style="position: absolute!important;z-index: 1000 !important;"
        ></lightning-spinner>
    </div>

    <div class="table-responsive">
        <table class="slds-table table slds-scrollable_y ownTable table-style">

            <tbody>
                <template lwc:if={productsInCart}>
                    <tr class="slds-hint-parent" for:each={cartArray} for:item="item" key={item}
                    style="cursor: pointer; border-bottom: 1px solid lightgray;">

                            <td class="slds-cell-wrap slds-border_right" colspan="7">

                                <table>

                                    <thead >
                                        <tr>
                                            <th colspan="7">
                                                <b>GST {item.gst}%</b>
                                            </th>
                                        </tr>
                                        <tr class="slds-line-height_reset">
                                           <th class="th-background slds-border_right">Action</th>
                                           <th class="th-background slds-border_right">Product Code</th>
                                           <th class="th-background slds-border_right">Description</th>
                                           <th class="th-background slds-border_right">Unit Price</th>
                                           <th class="th-background slds-border_right">Quantity</th>
                                           <th class="th-background slds-border_right">GST Amount</th>
                                           <th class="th-background slds-border_right">Exe Amount</th>
                                           <!-- <th class="th-background slds-border_right">Inc Amount</th> -->
                                        </tr>
                                     </thead>
                                    <template for:each={item.items} for:item="inner" for:index="index">
                                        <tr key={inner}>

                                            <td class="slds-cell-wrap slds-border_right">
                                                <lightning-icon
                                                    icon-name="action:close"
                                                    size="xx-small"
                                                    variant="inverse"
                                                    alternative-text="Remove Products"
                                                    onclick={removeProduct}
                                                    data-item={inner.id}
                                                    >
                                                </lightning-icon>
                                            </td>
                                            <td class="slds-cell-wrap slds-border_right">{inner.proName}</td>
                                            <td class="slds-cell-wrap slds-border_right">{inner.description}</td>
                                            <td class="slds-cell-wrap slds-border_right"><lightning-formatted-number value={inner.price} format-style="currency"
                                                minimum-integer-digits="2"></lightning-formatted-number></td>
                                            <td class="slds-cell-wrap slds-border_right">
                                                <lightning-button-icon
                                                    icon-name="utility:dash"
                                                    variant="bare"
                                                    size="small"
                                                    alternative-text="Decrease Quantity"
                                                    onclick={updateQty}
                                                    data-type="Minus"
                                                    data-key={inner.id} >
                                                </lightning-button-icon>
                                                    <span class="slds-m-horizontal_medium">{inner.qty} </span>
                                                    <lightning-button-icon
                                                    icon-name="utility:add"
                                                    variant="bare"
                                                    size="small"
                                                    alternative-text="Increase Quantity"
                                                    onclick={updateQty}
                                                    data-type="Plus"
                                                    data-key={inner.id}>
                                                </lightning-button-icon>
                                            </td>
                                            <td class="slds-cell-wrap slds-border_right"><lightning-formatted-number value={inner.totGstAmt} format-style="currency"
                                                minimum-integer-digits="2"></lightning-formatted-number></td>
                                            <td class="slds-cell-wrap slds-border_right"><lightning-formatted-number value={inner.exeAmt} format-style="currency"
                                                minimum-integer-digits="2"></lightning-formatted-number></td>
                                            <!-- <td class="slds-cell-wrap slds-border_right"><lightning-formatted-number value={inner.incAmt} format-style="currency"
                                                minimum-integer-digits="2"></lightning-formatted-number></td> -->
                                        </tr>
                                    </template>

                                </table>

                            </td>

                        </tr>
                </template>
                <template lwc:else>
                    <tr class="slds-hint-parent" style="cursor: pointer; border-bottom: 1px solid lightgray;">

                            <td class="slds-cell-wrap slds-border_right" colspan="7">

                                <table>

                                    <thead >
                                        <tr class="slds-line-height_reset">
                                           <th class="th-background slds-border_right">Action</th>
                                           <th class="th-background slds-border_right">Product Code</th>
                                           <th class="th-background slds-border_right">Description</th>
                                           <th class="th-background slds-border_right">Unit Price</th>
                                           <th class="th-background slds-border_right">Quantity</th>
                                           <th class="th-background slds-border_right">GST Amount</th>
                                           <th class="th-background slds-border_right">Exe Amount</th>
                                           <!-- <th class="th-background slds-border_right">Inc Amount</th> -->
                                        </tr>
                                     </thead>
                                     <tbody>
                                        <tr>
                                            <td colspan="7" class="slds-cell-wrap slds-border_right">
                                                <h4><span class="no-product" onclick={handleNavigation} data-type="standard__namedPage" data-name="home">Continue Shopping ! </span>No Product in your cart.</h4>
                                            </td>
                                        </tr>
                                     </tbody>

                                </table>

                            </td>

                        </tr>
                </template>
             </tbody>
             <tfoot>
                <tr>
                    <td ></td>
                    <td ></td>
                    <td ></td>
                    <td ></td>
                    <td ></td>
                    <td class="slds-cell-wrap slds-border_right" style="width: 12.5%;">Total Exculsive Amount</td>
                    <td class="slds-cell-wrap slds-border_right" style="width: 13%;">
                        <lightning-formatted-number value={totalExeAmt} format-style="currency"
                        minimum-integer-digits="2"></lightning-formatted-number>
                    </td>
                </tr>
                <tr>
                    <td ></td>
                    <td ></td>
                    <td ></td>
                    <td ></td>
                    <td ></td>
                    <td class="slds-cell-wrap slds-border_right" style="width: 12.5%;">Total GST Amount</td>
                    <td class="slds-cell-wrap slds-border_right" style="width: 13%">
                        <lightning-formatted-number value={totalGstAmount} format-style="currency"
                        minimum-integer-digits="2"></lightning-formatted-number>
                    </td>
                </tr>
                <tr>
                    <td ></td>
                    <td ></td>
                    <td ></td>
                    <td ></td>
                    <td ></td>
                    <td class="slds-cell-wrap slds-border_right" style="width: 12.5%;">Total Amount</td>
                    <td class="slds-cell-wrap slds-border_right" style="width: 13%;">
                        <lightning-formatted-number value={totalIncAmt} format-style="currency"
                        minimum-integer-digits="2"></lightning-formatted-number>
                    </td>
                </tr>
             </tfoot>
        </table>
    </div>






    <div class="button-grid slds-m-top_x-large">
        <lightning-button onclick={handleNavigation}
        variant="brand"
        icon-name="utility:add"
        data-type="standard__namedPage"
        class="my-cus-button"
        data-name="home" label="Add More">
        </lightning-button>
        <lightning-button onclick={handleNavigation}
        icon-name="utility:checkout"
        variant="brand" data-type="comm__namedPage"
        class="my-cus-button"
        data-name="checkout" label="Checkout">
        </lightning-button>
    </div>

</c-container>
</template>